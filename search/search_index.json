{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"SIG/AltArch Wiki","text":""},{"location":"#links","title":"Links","text":""},{"location":"#responsibilities","title":"Responsibilities","text":""},{"location":"#meetings-communications","title":"Meetings / Communications","text":""},{"location":"#members","title":"Members","text":""},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"RISCV64/visionfive_2/","title":"The VisionFive 2 SBC's Wiki","text":"<p>The VisionFive 2 SBC is the second generation of SBC in the VisionFive SBC lineup. This lineup of SBCs contains SoCs with the CPUs that use the RISC-V open computing ISA.</p> <p>This Wiki contains the necessary information a user needs to know before using Rocky Linux on the VisionFive 2 SBC.</p>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#technical-guide","title":"Technical guide","text":"","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#hardware-specifications","title":"Hardware specifications","text":"Item Description Processor/SoC StarFive JH7110 (<code>rv64imafdcbx</code> with up-to 1.5GHz max freq) Memory LPDDR4: 2GB/4GB/8GB Storage SD card slot SPI flash for u-boot Video Output HDMI 2.0 MIPI-DSI Multimedia Camera with MIPI CSI (up-to 2160p@30fps) Decoding: H.264 &amp; H.265 at 2160p@60fps Encoding: H.264 &amp; H.265 at 1080p@30fps JPEG Encoder and Decoder 1/4-pole stereo audio Connectivity 2x RJ45 Gigabit Ethernet (some models have 1x 100Mbit instead) 4x USB 3.0 (some models have 2x USB 2.0) M.2 M-Key NVMe drive slot Power in USB-C port: Qualcomm Quick Charge 3.0 compatible GPIO power in: 5V/3A PoE (\"pin compatible with RPi PoE HAT\") GPIO 40-pin GPIO header Dimensions 100mm x 72mm Button(s) Hardware reset button Other Debug pin headers","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#software-statusinformation","title":"Software status/information","text":"<p>At the time of writing this Wiki, the software support is still being upstreamed by the hardware vendor. More details about their upstreaming efforts and the merge status of each component can be viewed at rvspace.org.</p>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#relevant-software-repositories","title":"Relevant software repositories:","text":"<p>Following are the necessary arch/board specific software repositories. These are here for curious tinkerers and Rocky Linux maintainers. Suffice to say, as a normal user, you are not expected to touch/compile any of these items </p>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#fully-upstreamed","title":"Fully upstreamed","text":"<ul> <li>opensbi (package name: <code>TBD</code>)</li> </ul>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#downstream-forks-upstream-wip","title":"Downstream forks (upstream WIP)","text":"<ul> <li> <p>u-boot (package name: <code>TBD</code>)</p> </li> <li> <p>linux (package name: <code>TBD</code>)</p> </li> <li> <p>third party software tools/drivers (package name: <code>TBD</code>)</p> </li> </ul>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#installation","title":"Installation","text":"<p>To install Rocky Linux on the VisionFive 2 SBC, there is one pre-requisite that needs to be satisfied. That is to update the board firmware to v2.11.5.</p> <p>Editor's note: StarFive (the hardware vendor) is almost done sending in mainlining patches for u-boot and we should be able to switch to upstream u-boot soon. Our u-boot package for the VisionFive 2 should automatically update the board firmware to whatever version we support. But the following section is present nonetheless, for the users who have an outdated firmware than what we (Rocky Linux) have a minimum spec bar for.</p>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#pre-requisite-update-board-firmware","title":"Pre-requisite: Update board firmware","text":"<p>NOTE: PLEASE READ THESE STEPS AND CAREFULLY FOLLOW THEM. IF DONE INCORRECTLY, YOUR BOARD MAY GET BRICKED!</p> <ol> <li>Download the following files:</li> <li>sdcard.img (this image is from release v2.8.0)</li> <li>u-boot-spl.bin.normal.out</li> <li> <p>visionfive2_fw_payload.img</p> </li> <li> <p><code>sudo dd if=sdcard.img conv=sync status=progress bs=1M of=/dev/sdX</code></p> </li> <li> <p><code>mkdir temp-dir</code></p> </li> <li> <p><code>sudo mount /dev/sdX4 temp-dir</code></p> </li> <li> <p><code>sudo cp u-boot-spl.bin.normal.out visionfive2_fw_payload.img temp-dir/root/</code></p> </li> <li> <p><code>sudo sync; sudo sync; sudo sync; sudo sync;</code></p> </li> <li> <p><code>sudo umount temp-dir</code></p> </li> <li> <p>Eject the SD card from your computer, insert it in your VisionFive 2 and power it up. The green LED should start blinking to indicate successful board power-up.</p> </li> <li> <p>Plug the network cable in the Ethernet port that is next to the HDMI port. (The other port has DHCP-related issues with early firmware.)</p> </li> <li> <p><code>ssh root@&lt;IP_ADDRESS&gt;</code> (passwd: <code>starfive</code>)</p> </li> <li> <p>Run the command <code>cat /proc/mtd</code> and you should have the following output: <pre><code>dev: size erasesize name\nmtd0: 00020000 00001000 \"spl\"\nmtd1: 00300000 00001000 \"uboot\"\nmtd2: 00100000 00001000 \"data\"\n</code></pre></p> </li> <li> <p>If and only if the partition information given above matches with yours, update the <code>spl</code> and <code>uboot</code> partitions using the following commands: <pre><code>flashcp -v u-boot-spl.bin.normal.out /dev/mtd0\nflashcp -v visionfive2_fw_payload.img /dev/mtd1\n</code></pre></p> </li> </ol> <p>The board firmware has now been updated!</p>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#current-things-that-are-wip","title":"Current things that are WIP","text":"<p>A Rocky Linux image </p>","tags":["riscv","starfive","visionfive"]},{"location":"RISCV64/visionfive_2/#maintainers","title":"Maintainers","text":"<p>There are several developers who are working on the RISC-V port of Rocky Linux in general, but following are all the maintainers who are supporting the VisionFive 2 SBC. These usernames are what they use on the Rocky Linux Mattermost chat.</p> <ul> <li>@codedude</li> <li>@skip77</li> <li>@neil</li> <li>@pgreco</li> <li>@tgo</li> <li>@mustafa</li> <li>@alangm</li> <li>@sherif</li> <li>@thefossguy</li> </ul>","tags":["riscv","starfive","visionfive"]},{"location":"RPi/solutions/solutions/","title":"Solutions and Troubleshooting","text":""},{"location":"RPi/solutions/solutions/#dnf-always-claims-to-require-a-restart","title":"<code>dnf</code> always claims to require a restart","text":""},{"location":"RPi/solutions/solutions/#symptom","title":"Symptom","text":"<p>Even though the system has been restarted recently, e.g., after a Kernel update, <code>dnf needs-restarting -r</code> always returns with exit code <code>1</code>.</p> <pre><code># dnf needs-restarting -r\nCore libraries or services have been updated since boot-up:\n  * dbus\n  * dbus-daemon\n  * glibc\n  * linux-firmware\n  * systemd\n\nReboot is required to fully utilize these updates.\nMore information: https://access.redhat.com/solutions/27943\n</code></pre> <p>This affects both Rocky Linux 8 and 9. However, a patch for 9.3 is to be released soon.</p>"},{"location":"RPi/solutions/solutions/#cause","title":"Cause","text":"<p>The <code>dnf</code> plugin uses the <code>mtime</code> of <code>/proc/1</code> which is set to start of epoch due to lack of RTC on Raspberry Pi. The correct system time is set later at boot once network connectivity is established and an NTP server is reachable. Compared to 1970, every package update is after the last reboot which causes the wrong result.</p>"},{"location":"RPi/solutions/solutions/#solution","title":"Solution","text":"<p>Until 9.3 is released, or if the system is still on 8.x, the patch can be manually applied to all versions.</p> <pre><code># patch /usr/lib/python3.6/site-packages/dnf-plugins/needs_restarting.py &lt;&lt;EOF\n--- a/plugins/needs_restarting.py\n+++ b/plugins/needs_restarting.py\n@@ -34,6 +34,7 @@ import functools\n import os\n import re\n import stat\n+import time\n\n\n # For which package updates we should recommend a reboot\n@@ -199,7 +200,28 @@ class ProcessStart(object):\n\n     @staticmethod\n     def get_boot_time():\n-        return int(os.stat('/proc/1').st_mtime)\n+        \"\"\"\n+        We have two sources from which to derive the boot time. These values vary\n+        depending on containerization, existence of a Real Time Clock, etc.\n+        For our purposes we want the latest derived value.\n+        - st_mtime of /proc/1\n+             Reflects the time the first process was run after booting\n+             This works for all known cases except machines without\n+             a RTC - they awake at the start of the epoch.\n+        - /proc/uptime\n+             Seconds field of /proc/uptime subtracted from the current time\n+             Works for machines without RTC iff the current time is reasonably correct.\n+             Does not work on containers which share their kernel with the\n+             host - there the host kernel uptime is returned\n+        \"\"\"\n+\n+        proc_1_boot_time = int(os.stat('/proc/1').st_mtime)\n+        if os.path.isfile('/proc/uptime'):\n+            with open('/proc/uptime', 'rb') as f:\n+                uptime = f.readline().strip().split()[0].strip()\n+                proc_uptime_boot_time = int(time.time() - float(uptime))\n+                return max(proc_1_boot_time, proc_uptime_boot_time)\n+        return proc_1_boot_time\n\n     @staticmethod\n     def get_sc_clk_tck():\n-- \n2.41.0\nEOF\n</code></pre> <p>It is advisable to <code>version-lock</code> the plugin version until it's fixed upstream. On 8.x, that might be the only solutions if the patch is not backported to 8.x upstream. Use at your own risk!</p> <pre><code># dnf versionlock add python3-dnf-plugins-core\n</code></pre>"},{"location":"support/hardware/supported/","title":"Rocky Linux Supported SBC Hardware Models","text":""},{"location":"support/hardware/supported/#raspberry-pi-sbcs","title":"Raspberry Pi SBCs","text":"Model Image Status Pi 4B RockyLinux_Rpi_9-latest.img.xz Complete Pi 3B/B+ RockyLinux_Rpi_9-latest.img.xz Complete"},{"location":"support/hardware/supported/#banana-pi","title":"Banana Pi","text":"Model Status Unknown Stage 1(hardware being procured)"},{"location":"support/hardware/supported/#orange-pi","title":"Orange Pi","text":"Model Status Unknown Stage 1(hardware being procured)"},{"location":"support/hardware/supported/#pine","title":"Pine","text":"Model Image Status Pine64 Stage 1(hardware being obtained) RockPro64 Rocky-9.1-aarch64-generic-Minimal-rk3399-sda.raw.tar.gz Complete A64_LTS Stage 1(hardware being obtained)"},{"location":"support/hardware/supported/#libre-computer","title":"Libre Computer","text":"Model Status Renegade Stage 2(hw obtained, initial testing to discover whats needed) La Frite Stage 2(hw obtained, initial testing to discover whats needed) Tritium Stage 2(hw obtained, initial testing to discover whats needed) Le Potato Stage 2(hw obtained, initial testing to discover whats needed)"},{"location":"support/hardware/supported/#ordoid","title":"Ordoid","text":"Model Status N2+ Stage 2(hw obtained, initial testing to discover what's needed)"},{"location":"support/hardware/supported/#khadas","title":"Khadas","text":"<p>| Model         | Image                             | Status        | |---------------|---------------------------------------------------| | In early phases of discovery. |  |  |</p>"}]}